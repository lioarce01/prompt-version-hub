# ================================
# Docker Compose Configuration
# ================================
#
# NOTE: This file is now optional since the backend has been migrated to Supabase.
# The frontend can run standalone using: cd frontend && npm run dev
#
# This file is kept for users who prefer to run the frontend in Docker.
# ================================

services:
  # Next.js Frontend (Optional - can run with npm run dev instead)
  frontend:
    build:
      context: ./frontend
      dockerfile: ../docker/frontend.Dockerfile
    container_name: prompt-hub-frontend
    restart: unless-stopped
    environment:
      # Supabase Configuration
      NEXT_PUBLIC_SUPABASE_URL: ${NEXT_PUBLIC_SUPABASE_URL}
      NEXT_PUBLIC_SUPABASE_ANON_KEY: ${NEXT_PUBLIC_SUPABASE_ANON_KEY}
      SUPABASE_SERVICE_ROLE_KEY: ${SUPABASE_SERVICE_ROLE_KEY}

      # Google AI Configuration (optional)
      GOOGLE_GENAI_API_KEY: ${GOOGLE_GENAI_API_KEY:-}
      GOOGLE_GENAI_MODEL: ${GOOGLE_GENAI_MODEL:-gemini-2.0-flash-exp}

      # App Configuration
      NEXT_PUBLIC_APP_NAME: ${NEXT_PUBLIC_APP_NAME:-Prompt Version Hub}
      ENV: ${ENV:-development}
    ports:
      - "3000:3000"
    volumes:
      # For development - enable hot reload
      - ./frontend/src:/app/src:ro
      - ./frontend/public:/app/public:ro
    networks:
      - prompt-hub-network

networks:
  prompt-hub-network:
    name: prompt-hub-network
    driver: bridge

# ================================
# Migration Notes
# ================================
#
# The previous PostgreSQL and FastAPI backend services have been removed.
# All backend functionality is now provided by Supabase:
#
# - Database: Supabase PostgreSQL (managed cloud service)
# - Authentication: Supabase Auth
# - Storage: Supabase Storage (if needed in future)
# - Edge Functions: Supabase Edge Functions (for AI operations)
#
# To run the application:
#
# Option 1 (Recommended): Run frontend directly
#   cd frontend
#   npm install
#   npm run dev
#
# Option 2: Use Docker Compose
#   docker-compose up -d
#
# Setup Requirements:
# 1. Create a Supabase project at https://supabase.com
# 2. Run the migration in supabase/migrations/00001_initial_schema.sql
# 3. Configure .env.local with your Supabase credentials
# 4. (Optional) Deploy Edge Functions with Supabase CLI
#
# See SUPABASE_MIGRATION.md for detailed setup instructions.
# ================================
